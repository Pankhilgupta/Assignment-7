#include <iostream>
using namespace std;
void bubble_sort(int arr[],int n){
    int i,j;
    for(i=0;i<n;i++){
        for(j=0;j<n-i-1;j++){
            if(arr[j]>arr[j+1]){
                int temp=arr[j];
                arr[j]=arr[j+1];
                arr[j]=temp;
            }
        }
    }
}
void optimised_bubblesort(int arr[] , int n){
    int i,j;
    bool flag;
    for(i=0;i<n;i++){
        flag=false;
        for(j=0;j<n;j++){
            if(arr[j]>arr[j+1]){
                int temp=arr[j];
                arr[j]=arr[j+1];
                arr[j]=temp;
                flag=true;
            }
        }
        if(flag==false){
            break;
        }
    }
}
void selection_sort(int arr[] , int n){
    int i,j;
    for(i=0;i<n-1;i++){
        int min=i;
        for(j=i+1;j<n;j++){
            if(arr[j]<arr[min]){
                min=j;
            }
        }
        if(min != i){
            int temp=arr[min];
            arr[min]=arr[i];
            arr[i]=temp;
        }
    }
}
void insertion_sort(int arr[] , int n){
    int i,j;
    for(i=1;i<n;i++){
        int temp=arr[i];
        for(j=i;j>0;j--){
            if(arr[j-1]>temp){
                arr[j]=arr[j-1];
            }
        }
        arr[j]=temp;
    }
}
int partition(int arr[] , int p){
    int i=-1, j=0;
    while(j!=p){
        if(arr[j] <= arr[p]){
            i=i+1;
            int temp=arr[i+1];
            arr[i+1]=arr[j];
            arr[j]=temp;
        }
        j++;
    }
    int temp=arr[i+1];
    arr[i+1]=arr[p];
    arr[p]=temp;
    
    return i+1;
}
void quick_sort(int arr[]  , int p){
    if(p<=0) return;
   
    int q= partition(arr, p);
    quick_sort(arr,q-1);
    quick_sort(arr+q+1,p-q-1);
   
}
void merge(int arr[] , int low,  int mid, int high){
    int temp[1000];
    int left=low,k=0;
    int right=mid+1;
    while(left<=mid && right<=high){
        if(arr[left]<=arr[right]){
            temp[k++]=arr[left];
            left++;
        }
        else{
            temp[k++]=arr[right];
            right++;
        }
    }
    while(left<=mid){
        temp[k++]=arr[left];
        left++;
    }
    while(right<=high){
        temp[k++]=arr[right];
        right++;
    }
    int i;
    for(i=low;i<=high;i++){
        arr[i]=temp[i-low];
    }
}
void merge_sort(int arr[] , int low , int high){
    if(low>=high) return ;
    int mid= low+(high-low)/2;
    merge_sort(arr,low,mid);
    merge_sort(arr,mid+1,high);
    merge(arr,low,mid,high);
}
void display(int arr[], int n){
    for(int i=0;i<n;i++) cout<<arr[i]<<" ";
    cout<<endl;
}
int main() {
    int n;
    cout << "Enter number of elements: ";
    cin >> n;
    int arr[n];
    cout << "Enter elements: ";
    for(int i=0;i<n;i++) cin >> arr[i];

    cout << "\nChoose Sorting Algorithm:\n";
    cout << "1. Insertion Sort\n2. Selection Sort\n3. Bubble Sort\n4. Merge Sort\n5. Quick Sort\n";
    int choice;
    cin >> choice;

    switch(choice){
        case 1: insertion_sort(arr, n); break;
        case 2: selection_sort(arr, n); break;
        case 3: bubble_sort(arr, n); break;
        case 4: merge_sort(arr, 0, n-1); break;
        case 5: quick_sort(arr, n-1); break;
        case 6: optimised_bubblesort(arr, n); break;
        default: cout << "Invalid choice!\n"; return 0;
    }

    cout << "Sorted array: ";
    display(arr, n);

    return 0;
}
